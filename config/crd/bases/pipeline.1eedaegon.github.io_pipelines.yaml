---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.14.0
  name: pipelines.pipeline.1eedaegon.github.io
spec:
  group: pipeline.1eedaegon.github.io
  names:
    kind: Pipeline
    listKind: PipelineList
    plural: pipelines
    singular: pipeline
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: State
      jsonPath: .status.state
      name: State
      type: string
    - description: Start date
      jsonPath: .status.startDate
      name: StartDate
      type: string
    - description: Finish date
      jsonPath: .status.finishDate
      name: FinishDate
      type: string
    - description: initializing
      jsonPath: .status.initializing
      name: Initializing
      type: number
    - description: running
      jsonPath: .status.running
      name: running
      type: number
    - description: completed
      jsonPath: .status.completed
      name: completed
      type: number
    name: v1
    schema:
      openAPIV3Schema:
        description: Pipeline is the Schema for the pipelines API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: "schedule: # Schedule의 cron과 runAfter/runBefore가 동시에 걸리면
              경고를 띄운다. => after는 하위 시간 무시, before는 상위가 나를 무시\n\n\n\ttype: cron\n\tinterval:
              \"5 * * * * *\"\n\n\n# schedule:\n#   type: date\n#   startAt: \"2024-06-30:16:00:00\"\nrunAfter:
              []\nrunBefore: [] # runBefore를 걸었을 때 tasks/pipeline에 해당 이름이 없으면 경고를
              띄운다.\ntasks:\nPipelineSpec defines the desired state of Pipeline"
            properties:
              inputs:
                items:
                  type: string
                type: array
              name:
                description: |-
                  INSERT ADDITIONAL SPEC FIELDS - desired state of cluster
                  Important: Run "make" to regenerate code after modifying this file
                type: string
              outputs:
                items:
                  type: string
                type: array
              runAfter:
                items:
                  type: string
                type: array
              runBefore:
                items:
                  type: string
                type: array
              schedule:
                properties:
                  startAt:
                    type: string
                  type:
                    type: string
                type: object
              tasks:
                items:
                  description: "- name: load-data\nimage: nginx\ncommand:\n- aws s3\nargs:\n-
                    \"cp s3://something\"\n# Schedule의 cron과 runAfter/runBefore가 동시에
                    걸리면 경고를 띄운다. => after는 하위 시간 무시, before는 상위가 나를 무시\n# cron일 때
                    pipeline에 schedule이 걸려있으면 경고를 띄운다.\nschedule:\n\n\n\ttype: date\n\tstartAt:
                    \"2024-06-30:16:00:00\"\n\n\nrunBefore: []\nrunAfter:\n- transform-data\ninputs:
                    [] # runBefore와 inputs가 동시에 걸리고 runBefore의 task에 output이 없으면 경고를
                    띄운다.\noutputs: []\nresource:\n\n\n\t  cpu: 1\n\t  memory: 2Mi\n\t
                    \ gpu:\n\t\ttype: nvidia # gpu를 걸고 타입을 걸었을 때 node label에 없으면 경고를
                    띄운다.\n\t\tamount: 2\n\n\nTaskSpec defines the desired state of
                    Task"
                  properties:
                    args:
                      items:
                        type: string
                      type: array
                    command:
                      items:
                        type: string
                      type: array
                    image:
                      type: string
                    inputs:
                      items:
                        type: string
                      type: array
                    name:
                      description: |-
                        INSERT ADDITIONAL SPEC FIELDS - desired state of cluster
                        Important: Run "make" to regenerate code after modifying this file
                      type: string
                    outputs:
                      items:
                        type: string
                      type: array
                    resource:
                      properties:
                        cpu:
                          type: integer
                        gpu:
                          properties:
                            amount:
                              type: integer
                            type:
                              type: string
                          type: object
                        memory:
                          type: string
                      type: object
                    runAfter:
                      items:
                        type: string
                      type: array
                    runBefore:
                      items:
                        type: string
                      type: array
                    schedule:
                      properties:
                        startAt:
                          type: string
                        type:
                          type: string
                      type: object
                  type: object
                type: array
            type: object
          status:
            description: "\tstate: running\n\t startDate: 2024-05-13:16:00:00\n\t
              finishDate: 2024-05-13:17:00:00\n\t initializing: 1\n\t running: 1\n\t
              completed: 0\n\t currentJobs:\n\t - load-data\n\n\nPipelineStatus defines
              the observed state of Pipeline"
            properties:
              completed:
                type: integer
              currentJobs:
                items:
                  type: string
                type: array
              finishDate:
                format: date-time
                type: string
              initializing:
                type: integer
              jobs:
                items:
                  description: "status:\n\n\n\t  # name 뒤에 postfix가 붙어야한다.\n\t  state:
                    running\n\t  currentJobs:\n\t  - load-data-1\n\t  - load-data-2\n\t
                    \ startDate: 2024-05-13:16:00:00\n\t  finishDate: 2024-05-13:17:00:00\n\t
                    \ initializing: 1\n\t  running: 2\n\t  completed: 1\n\t  jobs:\n\t
                    \ - name: initialize-data\n\t    state: completed\n\t    runAfter:\n\t\t
                    \ - load-data-1\n\t\t  - load-data-2\n\t    startDate: 2024-05-13:16:00:00\n\t
                    \   finishDate: 2024-05-13:17:00:00S\n\n\nTaskStatus defines the
                    observed state of Task\nTask가 status를 갖는다는 의미는 job으로 변환되었다는 의미다."
                  properties:
                    finishDate:
                      type: string
                    name:
                      description: |-
                        INSERT ADDITIONAL STATUS FIELD - define observed state of cluster
                        Important: Run "make" to regenerate code after modifying this file
                      type: string
                    runAfter:
                      items:
                        type: string
                      type: array
                    runBefore:
                      items:
                        type: string
                      type: array
                    startDate:
                      type: string
                    state:
                      type: string
                  type: object
                type: array
              running:
                type: integer
              startDate:
                format: date-time
                type: string
              state:
                description: |-
                  INSERT ADDITIONAL STATUS FIELD - define observed state of cluster
                  Important: Run "make" to regenerate code after modifying this file
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
